# Pro100 Gym - Документация для Backend

Этот документ содержит основную информацию для разработчиков фронтенда по работе с бэкенд-сервисом приложения Pro100 Gym.

## 1. Обзор и документация API

Бэкенд предоставляет API для управления пользователями, их предпочтениями и генерации персонализированных планов тренировок.

**Полная интерактивная документация API (Swagger UI) доступна по адресу:**

[http://localhost:8000/docs#/](http://localhost:8000/docs#/)

Рекомендуется использовать эту документацию для изучения всех доступных эндпоинтов, их параметров и моделей данных.

## 2. Аутентификация

В приложении используется аутентификация на основе JWT (JSON Web Token). Чтобы получить доступ к защищенным эндпоинтам, необходимо получить токен и использовать его в заголовках последующих запросов.

### Шаг 1: Получение токена

Для получения токена необходимо отправить `POST` запрос на эндпоинт `/auth/login` с `username` и `password` в теле запроса (в формате `x-www-form-urlencoded`).
В ответ вы получите `access_token`.

**Авторизация в Swagger UI:**
В Swagger (`http://localhost:8000/docs#/`) для удобства тестирования можно использовать специальный эндпоинт. Нажмите на кнопку **"Authorize"** в правом верхнем углу, введите `username` и `password`, и Swagger автоматически получит токен и будет подставлять его во все запросы.

### Шаг 2: Использование токена

Для аутентификации на защищенных эндпоинтах (например, `GET /users/me`) необходимо передавать полученный токен в заголовке `Authorization`.

**Пример заголовка:**
```
Authorization: Bearer <ваш_access_token>
```

## 3. Основные сценарии работы

### 3.1. Профиль пользователя

- **Получение данных профиля:** `GET /users/me`
- **Обновление данных профиля:** `PATCH /users/me`
  - Этот эндпоинт позволяет частично обновлять данные пользователя, такие как `weight`, `height`, `age`, `fitness_goal` и т.д.

### 3.2. Предпочтения и ограничения

Это ключевая часть для персонализации тренировок.

1.  **Получение доступных опций:**
    - `GET /options/restriction-rules`: Получить список всех возможных ограничений по здоровью (например, "больные колени").
    - `GET /options/muscle-focuses`: Получить список всех доступных "акцентов" на группы мышц (например, "акцент на грудь" или "не хочу качать ноги").

2.  **Управление предпочтениями пользователя:**
    - `GET /preferences/me`: Получить текущие установленные предпочтения пользователя.
    - `PUT /preferences/me`: Установить или обновить предпочтения пользователя. В теле запроса передаются **списки идентификаторов (`id`)** выбранных опций.

    **Пример тела запроса для `PUT /preferences/me`:**
    ```json
    {
      "restriction_rule_ids": [1, 3],
      "muscle_focus_ids": [2, 5]
    }
    ```

### 3.3. План тренировок

- **Генерация нового плана:** `POST /workouts/generate`
  - Сервер сгенерирует новый план на основе данных профиля и предпочтений пользователя. Если у пользователя уже есть план, он будет **перезаписан**.
- **Получение текущего плана:** `GET /workouts/`
  - Возвращает текущий активный план тренировок.
- **Удаление плана:** `DELETE /workouts/`
  - Удаляет текущий план пользователя.
